#! DOCKER > wolfram -script output/Tests/PolynomialGCD_Tests.m
# SYSTEM: Mathematica_10
# TEST: PolynomialGCD_Tests
# The greatest common divisor of polynomials:
ok  PolynomialGCD[(1 + x)^2*(2 + x)*(4 + x), (1 + x)*(2 + x)*(3 + x)]    ==>     (1 + x)*(2 + x)
    ---
    data:
        got: (1 + x)*(2 + x)
        expect: (1 + x)*(2 + x)
        expect_evaluated: (1 + x)*(2 + x)
    ...
# The GCD of univariate polynomials:
ok  PolynomialGCD[x^4 - 4, x^4 + 4*x^2 + 4]    ==>     2 + x^2
    ---
    data:
        got: 2 + x^2
        expect: 2 + x^2
        expect_evaluated: 2 + x^2
    ...
# The GCD of multivariate polynomials:
ok  PolynomialGCD[x^2 + 2*x*y + y^2, x^3 + y^3]    ==>     x + y
    ---
    data:
        got: x + y
        expect: x + y
        expect_evaluated: x + y
    ...
# The GCD of more than two polynomials:
ok  PolynomialGCD[x^2 - 1, x^3 - 1, x^4 - 1, x^5 - 1, x^6 - 1, x^7 - 1]    ==>     -1 + x
    ---
    data:
        got: -1 + x
        expect: -1 + x
        expect_evaluated: -1 + x
    ...
# The GCD of rational functions:
ok  PolynomialGCD[(x - 1)*((x - 2)/((x - 3)*(x - 4))), (x - 1)*((x - 5)/((x - 3)*(x - 6)))]    ==>     (-1 + x)/((-6 + x)*(-4 + x)*(-3 + x))
    ---
    data:
        got: (-1 + x)/((-6 + x)*(-4 + x)*(-3 + x))
        expect: (-1 + x)/((-6 + x)*(-4 + x)*(-3 + x))
        expect_evaluated: (-1 + x)/((-6 + x)*(-4 + x)*(-3 + x))
    ...
# By default, algebraic numbers are treated as independent variables:
ok  PolynomialGCD[x^2 - 2, x - Sqrt[2]]    ==>     1
    ---
    data:
        got: 1
        expect: 1
        expect_evaluated: 1
    ...
# With RefLink[Extension,paclet:ref/Extension]->RefLink[Automatic,paclet:ref/Automatic], RefLink[PolynomialGCD,paclet:ref/PolynomialGCD] detects algebraically dependent coefficients:
ok  PolynomialGCD[x^2 - 2, x - Sqrt[2], Extension -> Automatic]    ==>     Sqrt[2] - x
    ---
    data:
        got: Sqrt[2] - x
        expect: Sqrt[2] - x
        expect_evaluated: Sqrt[2] - x
    ...
# Compute the GCD over the integers modulo 2:
ok  PolynomialGCD[(x + 1)^3, x^3 + x, Modulus -> 2]    ==>     (1 + x)^2
    ---
    data:
        got: (1 + x)^2
        expect: (1 + x)^2
        expect_evaluated: (1 + x)^2
    ...
# By default, RefLink[PolynomialGCD,paclet:ref/PolynomialGCD] treats trigonometric functions as independent variables:
ok  PolynomialGCD[Sin[2*x], 1 - Cos[x]^2]    ==>     1
    ---
    data:
        got: 1
        expect: 1
        expect_evaluated: 1
    ...
# With RefLink[Trig,paclet:ref/Trig]->RefLink[True,paclet:ref/True], RefLink[PolynomialGCD,paclet:ref/PolynomialGCD] recognizes dependencies between trigonometric functions:
ok  PolynomialGCD[Sin[2*x], 1 - Cos[x]^2, Trig -> True]    ==>     Sin[x]
    ---
    data:
        got: Sin[x]
        expect: Sin[x]
        expect_evaluated: Sin[x]
    ...
# Find common roots of univariate polynomials:
ok  f = x^7 - 2*x^5 - x^4 + 5*x^3 + 4*x^2 - 12*x + 5; g = x^7 - 9*x^5 + x^4 + 17*x^3 - 7*x^2 - 6*x + 3; d = PolynomialGCD[f, g]    ==>     1 - 2*x + x^3
    ---
    data:
        got: 1 - 2*x + x^3
        expect: 1 - 2*x + x^3
        expect_evaluated: 1 - 2*x + x^3
    ...
ok  x /. Solve[d == 0, x]    ==>     {1, (1/2)*(-1 - Sqrt[5]), (1/2)*(-1 + Sqrt[5])}
    ---
    data:
        got: {1, (-1 - Sqrt[5])/2, (-1 + Sqrt[5])/2}
        expect: {1, (1/2)*(-1 - Sqrt[5]), (1/2)*(-1 + Sqrt[5])}
        expect_evaluated: {1, (-1 - Sqrt[5])/2, (-1 + Sqrt[5])/2}
    ...
ok  Intersection[x /. Solve[f == 0, x], x /. Solve[g == 0, x]]    ==>     {1, (1/2)*(-1 - Sqrt[5]), (1/2)*(-1 + Sqrt[5])}
    ---
    data:
        got: {1, (-1 - Sqrt[5])/2, (-1 + Sqrt[5])/2}
        expect: {1, (1/2)*(-1 - Sqrt[5]), (1/2)*(-1 + Sqrt[5])}
        expect_evaluated: {1, (-1 - Sqrt[5])/2, (-1 + Sqrt[5])/2}
    ...
# Find multiple roots of univariate polynomials:
ok  f = x^9 - 7*x^8 + 19*x^7 - 27*x^6 + 35*x^5 - 77*x^4 + 145*x^3 - 157*x^2 + 88*x - 20; d = PolynomialGCD[f, D[f, x]]    ==>     -2 + 5*x - 4*x^2 + x^3
    ---
    data:
        got: -2 + 5*x - 4*x^2 + x^3
        expect: -2 + 5*x - 4*x^2 + x^3
        expect_evaluated: -2 + 5*x - 4*x^2 + x^3
    ...
ok  x /. Solve[d == 0, x]    ==>     {1, 1, 2}
    ---
    data:
        got: {1, 1, 2}
        expect: {1, 1, 2}
        expect_evaluated: {1, 1, 2}
    ...
ok  N[x /. Solve[f == 0, x]]    ==>     {1., 1., 1., 2., 2., -1.06876 - 1.26889*I, -1.06876 + 1.26889*I, 1.06876 - 0.821224*I, 1.06876 + 0.821224*I} # skip
# The GCD of polynomials divides the polynomials; use RefLink[PolynomialMod,paclet:ref/PolynomialMod] to prove it:
ok  f = x^7 - 2*x^5 - x^4 + 5*x^3 + 4*x^2 - 12*x + 5; g = x^7 - 9*x^5 + x^4 + 17*x^3 - 7*x^2 - 6*x + 3; d = PolynomialGCD[f, g]    ==>     1 - 2*x + x^3
    ---
    data:
        got: 1 - 2*x + x^3
        expect: 1 - 2*x + x^3
        expect_evaluated: 1 - 2*x + x^3
    ...
ok  PolynomialMod[{f, g}, d]    ==>     {0, 0}
    ---
    data:
        got: {0, 0}
        expect: {0, 0}
        expect_evaluated: {0, 0}
    ...
# RefLink[Cancel,paclet:ref/Cancel] divides the numerator and the denominator of a rational function by their GCD:
ok  Cancel[f/g]    ==>     (5 - 2*x + x^4)/(3 - 7*x^2 + x^4)
    ---
    data:
        got: (5 - 2*x + x^4)/(3 - 7*x^2 + x^4)
        expect: (5 - 2*x + x^4)/(3 - 7*x^2 + x^4)
        expect_evaluated: (5 - 2*x + x^4)/(3 - 7*x^2 + x^4)
    ...
# RefLink[PolynomialLCM,paclet:ref/PolynomialLCM] finds the least common multiple of polynomials:
ok  PolynomialLCM[f, g]    ==>     (5 - 2*x + x^4)*(3 - 6*x - 7*x^2 + 17*x^3 + x^4 - 9*x^5 + x^7)
    ---
    data:
        got: (5 - 2*x + x^4)*(3 - 6*x - 7*x^2 + 17*x^3 + x^4 - 9*x^5 + x^7)
        expect: (5 - 2*x + x^4)*(3 - 6*x - 7*x^2 + 17*x^3 + x^4 - 9*x^5 + x^7)
        expect_evaluated: (5 - 2*x + x^4)*(3 - 6*x - 7*x^2 + 17*x^3 + x^4 - 9*x^5 + x^7)
    ...
ok  Together[% - (f*g)/d]    ==>     0 # skip
# RefLink[Resultant,paclet:ref/Resultant] of two polynomials is zero if and only if their GCD has a nonzero degree:
ok  Resultant[x^2 - 4, x^2 + 4*x + 4, x]    ==>     0
    ---
    data:
        got: 0
        expect: 0
        expect_evaluated: 0
    ...
ok  PolynomialGCD[x^2 - 4, x^2 + 4*x + 4]    ==>     2 + x
    ---
    data:
        got: 2 + x
        expect: 2 + x
        expect_evaluated: 2 + x
    ...
ok  Resultant[3*x + 9, 6*x^3 - 3*x + 12, x]    ==>     -3807
    ---
    data:
        got: -3807
        expect: -3807
        expect_evaluated: -3807
    ...
ok  PolynomialGCD[3*x + 9, 6*x^3 - 3*x + 12]    ==>     3
    ---
    data:
        got: 3
        expect: 3
        expect_evaluated: 3
    ...
ok  Discriminant[f, x]    ==>     0 # skip
ok  PolynomialGCD[f, D[f, x]]    ==>     -1 + x # skip
ok  Discriminant[g, x]    ==>     5 # skip
ok  PolynomialGCD[g, D[g, x], x]    ==>     1
    ---
    data:
        got: 1
        expect: 1
        expect_evaluated: 1
    ...
# RefLink[Discriminant,paclet:ref/Discriminant] of a polynomial f is zero if and only if the polynomial has multiple roots:
ok  x /. Solve[f == 0, x]    ==>     {-2, 1, 1} # skip
ok  x /. Solve[g == 0, x]    ==>     {1, (1/2)*(-1 - Sqrt[5]), (1/2)*(-1 + Sqrt[5])} # skip
